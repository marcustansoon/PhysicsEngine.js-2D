
<canvas id="myCanvas" width="250" height="250"></canvas>

<script>
const imageUrl = "https://cdn.jsdelivr.net/gh/marcustansoon/PhysicsEngine.js-2D@master/temp/Games/BBQ-Sort/media/cucumber-slice.png";
const canvas = document.getElementById("myCanvas");
const ctx = canvas.getContext("2d");

function drawJigsawPath(ctx, size, tabSize, type) {
    ctx.beginPath();
    ctx.moveTo(0, 0); // Top-left corner

    // Top edge (straight)
    ctx.lineTo(size, 0);

    // Right edge with tab (protrusion)
    ctx.lineTo(size, size/2 - tabSize);
    ctx.bezierCurveTo(
        size + tabSize, size/2 - tabSize, // Control point 1
        size + tabSize, size/2 + tabSize, // Control point 2
        size, size/2 + tabSize            // End point
    );
    ctx.lineTo(size, size);

	
    // Draw bottom curve
    ctx.lineTo(size/2 + tabSize, size);
    ctx.bezierCurveTo(
        size/2 + tabSize, size + tabSize, // Control point 1 (below edge)
        size/2 - tabSize, size + tabSize, // Control point 2 (below edge)
        size/2 - tabSize, size            // End point (halfway across bottom)
    );
    // Bottom edge (straight)
    ctx.lineTo(0, size);

    // Left edge with socket (indentation)
    ctx.lineTo(0, size/2 + tabSize);
    ctx.bezierCurveTo(
        -tabSize, size/2 + tabSize, // Control point 1
        -tabSize, size/2 - tabSize, // Control point 2
        0, size/2 - tabSize         // End point
    );
    ctx.lineTo(0, 0);

    ctx.closePath();
}


// outline

function drawJigsawPathOutline(ctx, size, tabSize, type) {
    ctx.beginPath();
    
    ctx.moveTo(0, 0); // Top-left corner

    // Top edge (straight)
    ctx.lineTo(size, 0);

    // Right edge with tab (protrusion)
    ctx.lineTo(size, size/2 - tabSize);
    ctx.bezierCurveTo(
        size + tabSize + 0, size/2 - tabSize + 0, // Control point 1
        size + tabSize + 0, size/2 + tabSize + 0, // Control point 2
        size, size/2 + tabSize            // End point
    );
    ctx.lineTo(size, size);

	
    // Draw bottom curve
    ctx.lineTo(size/2 + tabSize, size);
    ctx.bezierCurveTo(
        size/2 + tabSize, size + tabSize + 0, // Control point 1 (below edge)
        size/2 - tabSize, size + tabSize + 0, // Control point 2 (below edge)
        size/2 - tabSize, size            // End point (halfway across bottom)
    );
    // Bottom edge (straight)
    ctx.lineTo(0, size);

    // Left edge with socket (indentation)
    ctx.lineTo(0, size/2 + tabSize);
    ctx.bezierCurveTo(
        -tabSize, size/2 + tabSize + 0, // Control point 1
        -tabSize, size/2 - tabSize + 0, // Control point 2
        0, size/2 - tabSize         // End point
    );
    ctx.lineTo(0, 0);

    ctx.closePath();
}



const img = new Image();
img.crossOrigin = "anonymous";
img.src = imageUrl;

img.onload = function() {
    console.log("Image loaded successfully:", img.width, img.height); // Debug image load
    const pieceSize = 50;
    const tabSize = 10; // Visible tab/socket

    // Save context to avoid state issues
    ctx.save();

    // Clear canvas to avoid overlap
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // Draw jigsaw path for clipping
    drawJigsawPath(ctx, pieceSize, tabSize);

    // Fill shape for visibility (debugging)
    ctx.fillStyle = "rgba(255, 0, 0, 0.2)"; // Light red fill
    ctx.fill();

    // Clip to jigsaw shape
    ctx.clip();

    // Draw image, starting at top-left of jigsaw shape
    const sourceSize = pieceSize + tabSize; // Source matches shape's max width
    ctx.drawImage(
        img,
        0, 0, sourceSize, sourceSize, // Source: square from image top-left
        0, 0, pieceSize + tabSize, pieceSize + tabSize // Destination: align top-left, cover tab
    );
    
    ctx.restore();
    
    
    
    
    
// Draw outline for second piece
ctx.save();

ctx.translate(45, 45); // Move position
drawJigsawPathOutline(ctx, pieceSize, tabSize);
    ctx.strokeStyle = "black";
            ctx.lineWidth = 2;
    ctx.stroke();
ctx.clip();

ctx.restore();

// Draw second piece
ctx.save();
ctx.translate(44, 44); // Move position
drawJigsawPath(ctx, pieceSize, tabSize);
    ctx.fillStyle = "rgba(255, 0, 0, 0.2)"; // Light red fill
    ctx.fill();
ctx.clip();
ctx.drawImage(img, 0, 0, sourceSize, sourceSize, 0, 0, pieceSize + tabSize, pieceSize + tabSize);
ctx.restore();
    
    
    
    
    
    // Image 2
    
};

img.onerror = function() {
    console.error("Failed to load image:", imageUrl);
};
</script>

